<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>EBAUI - API documentation : Source: Tab.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link href="styles/bootstrap.css" rel="stylesheet">
    <link href="styles/docs.css" rel="stylesheet">
    <link href="styles/bootstrap-custom.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
  </head>
  <body>
    <header class="header navbar navbar-inverse">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="brand" href="#"><strong>EBAUI</strong> API documentation</a>
        </div>
      </div>
    </header>

    <div class="container-fluid">
      <div class="row-fluid">
          <div class="span4">
              <h2><a href="index.html">Index</a></h2><div class="well well-small"><ul class="nav nav-list"><li class="nav-header">Namespaces</li><li><a href="ebaui.html"><i class="icon-code"></i> ebaui</a></li><li><a href="ebaui.web.html"><i class="icon-code"></i> web</a></li></ul></div><div class="well well-small"><ul class="nav nav-list"><li class="nav-header">Classes</li><li><a href="ebaui.web.Button.html"><i class="icon-shield" style="color: #0186d1"></i> Button</a></li><li><a href="ebaui.web.ButtonEdit.html"><i class="icon-shield" style="color: #0186d1"></i> ButtonEdit</a></li><li><a href="ebaui.web.Calendar.html"><i class="icon-shield" style="color: #0186d1"></i> Calendar</a></li><li><a href="ebaui.web.Captcha.html"><i class="icon-shield" style="color: #0186d1"></i> Captcha</a></li><li><a href="ebaui.web.CheckBox.html"><i class="icon-shield" style="color: #0186d1"></i> CheckBox</a></li><li><a href="ebaui.web.CheckBoxList.html"><i class="icon-shield" style="color: #0186d1"></i> CheckBoxList</a></li><li><a href="ebaui.web.Combo.html"><i class="icon-shield" style="color: #0186d1"></i> Combo</a></li><li><a href="ebaui.web.ComboBox.html"><i class="icon-shield" style="color: #0186d1"></i> ComboBox</a></li><li><a href="ebaui.web.ComboList.html"><i class="icon-shield" style="color: #0186d1"></i> ComboList</a></li><li><a href="ebaui.web.Control.html"><i class="icon-shield" style="color: #0186d1"></i> Control</a></li><li><a href="ebaui.web.DataGrid.html"><i class="icon-shield" style="color: #0186d1"></i> DataGrid</a></li><li><a href="ebaui.web.DateTimePicker.html"><i class="icon-shield" style="color: #0186d1"></i> DateTimePicker</a></li><li><a href="ebaui.web.Dialog.html"><i class="icon-shield" style="color: #0186d1"></i> Dialog</a></li><li><a href="ebaui.web.DigitValidator.html"><i class="icon-shield" style="color: #0186d1"></i> DigitValidator</a></li><li><a href="ebaui.web.EmailValidator.html"><i class="icon-shield" style="color: #0186d1"></i> EmailValidator</a></li><li><a href="ebaui.web.FileUploader.html"><i class="icon-shield" style="color: #0186d1"></i> FileUploader</a></li><li><a href="ebaui.web.Form.html"><i class="icon-shield" style="color: #0186d1"></i> Form</a></li><li><a href="ebaui.web.FormField.html"><i class="icon-shield" style="color: #0186d1"></i> FormField</a></li><li><a href="ebaui.web.Hidden.html"><i class="icon-shield" style="color: #0186d1"></i> Hidden</a></li><li><a href="ebaui.web.IdentityValidator.html"><i class="icon-shield" style="color: #0186d1"></i> IdentityValidator</a></li><li><a href="ebaui.web.Label.html"><i class="icon-shield" style="color: #0186d1"></i> Label</a></li><li><a href="ebaui.web.LengthValidator.html"><i class="icon-shield" style="color: #0186d1"></i> LengthValidator</a></li><li><a href="ebaui.web.ListBox.html"><i class="icon-shield" style="color: #0186d1"></i> ListBox</a></li><li><a href="ebaui.web.MobileValidator.html"><i class="icon-shield" style="color: #0186d1"></i> MobileValidator</a></li><li><a href="ebaui.web.OnlyCnValidator.html"><i class="icon-shield" style="color: #0186d1"></i> OnlyCnValidator</a></li><li><a href="ebaui.web.Panel.html"><i class="icon-shield" style="color: #0186d1"></i> Panel</a></li><li><a href="ebaui.web.Password.html"><i class="icon-shield" style="color: #0186d1"></i> Password</a></li><li><a href="ebaui.web.RadioList.html"><i class="icon-shield" style="color: #0186d1"></i> RadioList</a></li><li><a href="ebaui.web.RangeValidator.html"><i class="icon-shield" style="color: #0186d1"></i> RangeValidator</a></li><li><a href="ebaui.web.RemoteValidator.html"><i class="icon-shield" style="color: #0186d1"></i> RemoteValidator</a></li><li><a href="ebaui.web.RequiredValidator.html"><i class="icon-shield" style="color: #0186d1"></i> RequiredValidator</a></li><li><a href="ebaui.web.Spinner.html"><i class="icon-shield" style="color: #0186d1"></i> Spinner</a></li><li><a href="ebaui.web.Tab.html"><i class="icon-shield" style="color: #0186d1"></i> Tab</a></li><li><a href="ebaui.web.Tabs.html"><i class="icon-shield" style="color: #0186d1"></i> Tabs</a></li><li><a href="ebaui.web.TelephoneValidator.html"><i class="icon-shield" style="color: #0186d1"></i> TelephoneValidator</a></li><li><a href="ebaui.web.TextArea.html"><i class="icon-shield" style="color: #0186d1"></i> TextArea</a></li><li><a href="ebaui.web.TextBox.html"><i class="icon-shield" style="color: #0186d1"></i> TextBox</a></li><li><a href="ebaui.web.TimeSpinner.html"><i class="icon-shield" style="color: #0186d1"></i> TimeSpinner</a></li><li><a href="ebaui.web.TreeView.html"><i class="icon-shield" style="color: #0186d1"></i> TreeView</a></li><li><a href="ebaui.web.UiLayout.html"><i class="icon-shield" style="color: #0186d1"></i> UiLayout</a></li><li><a href="ebaui.web.UrlValidator.html"><i class="icon-shield" style="color: #0186d1"></i> UrlValidator</a></li><li><a href="ebaui.web.Validator.html"><i class="icon-shield" style="color: #0186d1"></i> Validator</a></li><li><a href="ebaui.web.ZipValidator.html"><i class="icon-shield" style="color: #0186d1"></i> ZipValidator</a></li></ul></div><div class="well well-small"><ul class="nav nav-list"><li class="nav-header">Public Events</li><li><a href="ebaui.web.Dialog.html#event:apply"><i class="icon-bell-alt" style="color: yellow"></i> apply <span class="label label-inverse pull-right">ebaui.web.Dialog</span></a></li><li><a href="ebaui.web.Dialog.html#event:cancel"><i class="icon-bell-alt" style="color: yellow"></i> cancel <span class="label label-inverse pull-right">ebaui.web.Dialog</span></a></li></ul></div><div class="well well-small"><ul class="nav nav-list"><li class="nav-header">Private Events</li></ul></div><div class="well well-small"><ul class="nav nav-list"><li class="nav-header">Global</li><li><a href="global.html#contentWindow"><i class="icon-globe" style="color: black;"></i> contentWindow</a></li><li><a href="global.html#items"><i class="icon-globe" style="color: black;"></i> items</a></li><li><a href="global.html#keyboard"><i class="icon-globe" style="color: black;"></i> keyboard</a></li><li><a href="global.html#val"><i class="icon-globe" style="color: black;"></i> val</a></li></ul></div>
          </div>

          <div class="span8">
              <h1 class="page-header">Source: Tab.js</h1>
              


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
*   @class      Tab
*   @classdesc
*   @memberof   ebaui.web
*   @extends    ebaui.web.Control
*   @author     monkey      &lt;knightuniverse@qq.com>
*   @param      {Object}    element     -   dom对象
*   @param      {Object}    options     -   控件配置参数
*/

var Tab, _ref,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Tab = (function(_super) {
  __extends(Tab, _super);

  function Tab() {
    _ref = Tab.__super__.constructor.apply(this, arguments);
    return _ref;
  }

  Tab.prototype._headerTmpl = '';

  /**
   *  dom对象引用
   *  @private
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Object}    _$header
  */


  Tab.prototype._$header = null;

  Tab.prototype._contentTmpl = '';

  /**
   *  dom对象引用
   *  @private
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Object}    _$header
  */


  Tab.prototype._$content = null;

  /**
   *  更新选项卡的icon
   *  @private
   *  @instance
   *  @memberof   ebaui.web.Tab
   *  @method     _updateCssIcon
  */


  Tab.prototype._updateCssIcon = function() {
    var cls, iconCls, me;
    me = this;
    iconCls = me.iconCls();
    cls = 'eba-tab-icon ';
    if (iconCls) {
      cls += iconCls;
    }
    return $('.eba-tab-icon', me._$header).attr('class', cls);
  };

  /**
   *  更新选项卡的关闭按钮
   *  @private
   *  @instance
   *  @memberof   ebaui.web.Tab
   *  @method     _updateCssClosable
  */


  Tab.prototype._updateCssClosable = function() {
    var $btnClose, $root, closable, me, size;
    me = this;
    closable = me.closable();
    $root = me.headerDom();
    $btnClose = $('span.eba-tab-close', $root);
    size = $btnClose.size();
    if (!closable && size > 0) {
      return $btnClose.remove();
    }
    return void 0;
  };

  /**
   *  
   *  @private
   *  @instance
   *  @memberof   ebaui.web.Tab
   *  @method     _updateAttrTitle
  */


  Tab.prototype._updateAttrTitle = function() {
    var me;
    me = this;
    return $('.eba-tab-text', me._$header).text(me.title());
  };

  Tab.prototype._contentLoaded = false;

  /**
   *  判断tab的内容是否已经加载完成
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Boolean}    contentLoaded
   *  @example
   *      var loaded = tab.contentLoaded()
  */


  Tab.prototype.contentLoaded = function() {
    return this._contentLoaded;
  };

  /**
   *  tab的header dom对象
   *  @private
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Object}    headerDom
  */


  Tab.prototype.headerDom = function() {
    return this._$header;
  };

  /**
   *  tab的content dom对象
   *  @private
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Object}    contentDom
  */


  Tab.prototype.contentDom = function() {
    return this._$content;
  };

  /**
   *  获取tab的内部的完成加载的iframe的contentWindow属性。
   *  如果iframe还没有完成加载或者因为跨域等问题获取失败，返回null
   *  @public
   *  @instance
   *  @member         {Object}    contentWindow
   *  @memberof       eabui.web.Tab
   *  @returns        contentWindows或者null
  */


  Tab.prototype.contentWindow = function() {
    var $ifm, e, me, win;
    me = this;
    if (!me.contentLoaded()) {
      return null;
    }
    $ifm = $('iframe', me._$content);
    if ($ifm.size() === 0) {
      return null;
    }
    win = null;
    try {
      win = $ifm.get(0).contentWindow;
    } catch (_error) {
      e = _error;
    }
    return win;
  };

  Tab.prototype._title = '';

  /**
   *  tab的标题
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {String}    title
  */


  Tab.prototype.title = function(val) {
    var me;
    me = this;
    if (val == null) {
      return me._title;
    }
    me._title = val;
    return me._updateAttrTitle();
  };

  Tab.prototype._url = '';

  /**
   *  tab内容的URL
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {String}    url
  */


  Tab.prototype.url = function(val) {
    var me;
    me = this;
    if (val == null) {
      return me._url;
    }
    me._url = val;
    return me.refresh();
  };

  Tab.prototype._closable = true;

  /**
   *  获取或者设置tab是否可以关闭
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {String}    closable
  */


  Tab.prototype.closable = function(val) {
    var me;
    me = this;
    if (val == null) {
      return me._closable;
    }
    me._closable = val;
    return me._updateCssClosable();
  };

  Tab.prototype._iconCls = '';

  /**
   *  tab的icon
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {String}    iconCls
  */


  Tab.prototype.iconCls = function(val) {
    var me;
    me = this;
    if (val == null) {
      return me._iconCls;
    }
    me._iconCls = val;
    me._updateCssIcon();
    return void 0;
  };

  Tab.prototype._isActived = false;

  /**
   *  tab是否激活
   *  @public
   *  @instance
   *  @default        false
   *  @memberof       eabui.web.Tab
   *  @member         {Boolean}    isActived
  */


  Tab.prototype.isActived = function(val) {
    var $content, $header, cls, me;
    me = this;
    if (me.isClosed()) {
      return;
    }
    if (typeof val !== 'boolean') {
      return me._isActived;
    }
    cls = 'eba-tab-active';
    $header = me._$header;
    $content = me._$content;
    me._isActived = val;
    if (val) {
      $header.addClass(cls);
      $content.show();
    } else {
      $header.removeClass(cls);
      $content.hide();
    }
    return void 0;
  };

  /**
   *  刷新tab页面的内容
   *  ，tab参数如果是一个int对象,那么直接将参数作为索引查找tab
   *  ，tab参数如果是一个string对象，那么默认按照tab的title属性进行查找
   *  ，tab参数如果是一个function对象，那么会在查找的过程中，使用指定的函数作为判等条件
   *  @public
   *  @instance
   *  @memberof       ebaui.web.Tabs
   *  @method         refreshTab
   *  @param          {Number|String|Function}        tab
  */


  Tab.prototype.refresh = function() {
    var me, timestamp, url;
    me = this;
    return me.isClosed();
    timestamp = (new Date).getTime();
    url = me.url();
    url += url.indexOf('?') === -1 ? "?t=" + timestamp : "&t=" + timestamp;
    return $('iframe', me._$content).attr('src', url);
  };

  Tab.prototype._closed = false;

  /**
   *  指示该选项卡是否已经被关闭了
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @member         {Boolean}   isClosed
  */


  Tab.prototype.isClosed = function() {
    return this._closed;
  };

  /**
   *  关闭选项卡
   *  @public
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @method         close
  */


  Tab.prototype.close = function() {
    var me;
    me = this;
    $('iframe', me._$content).off('load');
    me._closed = true;
    me._$header.remove();
    me._$content.remove();
    delete me._$header;
    return delete me._$content;
  };

  Tab.prototype._render = function() {
    var me;
    me = this;
    me._updateAttrTitle();
    me._updateCssClosable();
    return me._updateCssIcon();
  };

  /**
   *  初始化
   *  @private
   *  @instance
   *  @memberof       eabui.web.Tab
   *  @method         _init
  */


  Tab.prototype._init = function(opts) {
    var html, me, _ref1, _ref2, _ref3, _ref4, _ref5;
    me = this;
    /* 
    *   初始化控件自身的一系列属性
    */

    me._iconCls = (_ref1 = opts['iconCls']) != null ? _ref1 : '';
    me._url = (_ref2 = opts['url']) != null ? _ref2 : '';
    me._title = (_ref3 = opts['title']) != null ? _ref3 : me._url;
    me._closable = (_ref4 = opts['closable']) != null ? _ref4 : true;
    me._isActived = (_ref5 = opts['isActived']) != null ? _ref5 : false;
    /* 
    *   render header
    */

    me._$header = $(me._headerTmpl);
    /* 
    *   render content
    */

    html = me._contentTmpl.replace('{0}', me.url());
    return me._$content = $(html);
  };

  /**
   *  初始化DOM事件处理程序
   *  @private
   *  @instance
   *  @memberof       ebaui.web.Tabs
   *  @method         _setupEvents
  */


  Tab.prototype._setupEvents = function(opts) {
    var $content, $header, me;
    me = this;
    $header = me._$header;
    $content = me._$content;
    /**
    *   绑定事件处理程序
    */

    me.onEvent('load', opts['onload']);
    /**
    *   mouseenter
    *   https://developer.mozilla.org/en-US/docs/DOM/DOM_event_reference/mouseenter
    *
    *   当鼠标移到tab选项卡的时候，要添加关闭按钮
    *   当鼠标移出tab选项卡的时候，要删除关闭按钮
    *   &lt;span class="eba-tab-close">&lt;/span>
    *   span.eba-tab-close的click事件，由tabs集合负责处理
    *   单个tab对象，不应该处理自己的关闭事件，应该是由容器来统一负责移除，添加的操作
    */

    $header.on('mouseenter', function(eventArgs) {
      var $btn;
      $btn = $('span.eba-tab-close', $header);
      if (me.closable() && $btn.size() === 0) {
        $btn = $('&lt;span class="eba-tab-close">&lt;/span>');
        return $header.append($btn);
      }
    });
    $header.on('mouseleave', function(eventArgs) {
      var $btn;
      $btn = $('span.eba-tab-close', $header);
      return $btn.remove();
    });
    /**
    *   触发iframe的load事件
    */

    return $('iframe', $content).on('load', function(eventArgs) {
      /*
      *   设置变量，指示tab的content已经完成加载了
      */

      var contentDoc, error;
      me._contentLoaded = true;
      /*
      *   设置tab里iframe的document的click，使click事件能一级一级往上冒泡到最外层的document上
      */

      try {
        contentDoc = this.contentDocument || this.contentWindow.document;
        if (contentDoc) {
          $(contentDoc).on('click', function(eventArgs) {
            /*
            *   判断当前是否处在iframe里
            */

            var top, win;
            win = contentDoc.defaultView;
            top = win.top;
            /*
            *   如果当前页面是在iframe里面，则触发父页面document的click事件处理程序
            */

            if (win && top !== win) {
              return $(top.document).trigger('click');
            }
          });
        }
      } catch (_error) {
        error = _error;
        /*
        *   考虑到有跨域的可能，因此还是要try catch一下的
        */

      }
      return me.triggerEvent('load', eventArgs);
    });
  };

  return Tab;

})(Control);

ebaui['web'].registerControl('Tab', Tab);
</code></pre>
        </article>
    </section>




          </div>
      </div>

        <br clear="both">

      <footer>
        Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Mon Mar 24 2014 16:22:54 GMT+0800 (CST)
        <br>
      </footer>
      <script> prettyPrint(); </script>
    </div>
  </body>
</html>
